# Changes and Possible Issues with State-Machine version

To Do:
- Fix time synchronization issues!!!
	- e.g. sometimes Matlab decides that Reward_Window timed out while the Arduino registers a rewarded decision poke
	- Allow batch Arduino commands to execute atomically â€” DONE (to be tested)
	- What about Matlab: can a new Arduino message interrupt the execution of stateTransitionEvent???
		- Read docs on "Interrupt Callback Execution"

Low priority:
- Stop new stats/history files from overwriting old ones


DONE:
- Select path dialog: default to previous path (I think??)
- Add new laser stim type: center-in -> side-out
	- Accomplish this by adding a new checkbox:
		"Side laser follows center laser"
- **** Add "deliver extra reward button" (during experiment)
- Stop expt button: turn off all LEDs/Laser/reward
- Have Max-duration timeout for variable laser stim


pokeHistory.laser -> logs side laser state (as before)
	(can we change this to 'sideLaserState' ?)
pokeHistory.centerLaserState -> logs center laser state (new)
- Testing this out

Poke timing counts on NoseIn. If nose is in too long, next trial can already start. OK for now?

Overlapping laser stimuli interact in unexpected ways.

How to distinguish between mouse-elicited rewards (true rewards)
and "bonus" rewards manually delivered by experimenter
- Fixed... needs testing


After trial is initiated, does centerPoke count as "decision" "incorrect" poke? Transition to ITI??
-Yes

Need for Markov option? -NO


================================

# Errors in stats/history file format:
- every other poke is blank - FIXED
- 'L/R PortStatus' is missing ACTIVATE value - FIXED
- New stats file has empty 'sync_times' field, this is missing in old version
	- this actually seems right

=============

Manual Reward delivery:
- add log message 'Manual reward left/right'
- standard 'Reward delivered' message should also appear in log soon after
- Manual rewards do not show up in existing reward statistics
- But there is new field, pokeHistory(pokeCount).manualRewards, that lists the # of manual rewards triggered prior to that poke
	- the assumption is that manual rewards are triggered in between pokes. Is that true???

